{"paragraphs":[{"text":"// importing spark session\nimport org.apache.spark.sql.SparkSession","user":"anonymous","dateUpdated":"2020-04-15T01:21:49-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.SparkSession\n"}]},"apps":[],"jobName":"paragraph_1586639027292_-1758972499","id":"20200411-170347_992615406","dateCreated":"2020-04-11T17:03:47-0400","dateStarted":"2020-04-15T01:21:49-0400","dateFinished":"2020-04-15T01:21:49-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:236"},{"text":"// creating a spark session\nval spark = SparkSession.builder.master(\"local\").getOrCreate()","user":"anonymous","dateUpdated":"2020-04-15T01:21:56-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"spark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@27568814\n"}]},"apps":[],"jobName":"paragraph_1586639708777_-697564668","id":"20200411-171508_1001866373","dateCreated":"2020-04-11T17:15:08-0400","dateStarted":"2020-04-15T01:21:56-0400","dateFinished":"2020-04-15T01:21:56-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:237"},{"text":"// loading the data of Q2 into a single csv into Table A (final_df)\nval data_final = spark.read.format(\"csv\").option(\"header\", \"true\").load(\"data_Q2_SP20/*.csv\")","user":"anonymous","dateUpdated":"2020-04-15T01:25:23-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"data_final: org.apache.spark.sql.DataFrame = [date: string, serial_number: string ... 127 more fields]\n"}]},"apps":[],"jobName":"paragraph_1586639721749_-778108053","id":"20200411-171521_1407610132","dateCreated":"2020-04-11T17:15:21-0400","dateStarted":"2020-04-15T01:23:20-0400","dateFinished":"2020-04-15T01:23:23-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:238"},{"text":"// removing the data of the last data file to put into Table B\nval final_df = data_final.filter(data_final(\"date\") =!= \"2019-03-31.csv\")","user":"anonymous","dateUpdated":"2020-04-15T01:23:27-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"final_df: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date: string, serial_number: string ... 127 more fields]\n"}]},"apps":[],"jobName":"paragraph_1586640850947_1522732025","id":"20200411-173410_234313914","dateCreated":"2020-04-11T17:34:10-0400","dateStarted":"2020-04-15T01:23:27-0400","dateFinished":"2020-04-15T01:23:27-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:239"},{"text":"//The number of values in Table A after filtering\nfinal_df.count()","user":"anonymous","dateUpdated":"2020-04-15T01:24:04-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res3: Long = 9577046\n"}]},"apps":[],"jobName":"paragraph_1586640971734_1641337311","id":"20200411-173611_266105673","dateCreated":"2020-04-11T17:36:11-0400","dateStarted":"2020-04-15T01:23:01-0400","dateFinished":"2020-04-15T01:23:11-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:240"},{"text":"// loading the data of the last file into Table B (data_31)\nval data_31= spark.read.format(\"csv\").option(\"header\", \"true\").load(\"C:/Users/myste/Documents/MSCS/Spring 2020/Big Data/data_Q2_SP20/2019-03-31.csv\")","user":"anonymous","dateUpdated":"2020-04-15T01:25:35-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"data_31: org.apache.spark.sql.DataFrame = [date: string, serial_number: string ... 127 more fields]\n"}]},"apps":[],"jobName":"paragraph_1586640994650_1359755297","id":"20200411-173634_632483449","dateCreated":"2020-04-11T17:36:34-0400","dateStarted":"2020-04-15T01:24:34-0400","dateFinished":"2020-04-15T01:24:35-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:241"},{"text":"//count of the rows of the last file\ndata_31.count()","user":"anonymous","dateUpdated":"2020-04-15T01:26:15-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res4: Long = 106238\n"}]},"apps":[],"jobName":"paragraph_1586641062964_-1630797969","id":"20200411-173742_1104768160","dateCreated":"2020-04-11T17:37:42-0400","dateStarted":"2020-04-15T01:25:37-0400","dateFinished":"2020-04-15T01:25:37-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:242"},{"text":"// Applying bloom filter to Table B\nval final_bloomfilter=data_31.stat.bloomFilter(\"model\",data_31.count(),0.005)","user":"anonymous","dateUpdated":"2020-04-15T01:28:20-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"final_bloomfilter: org.apache.spark.util.sketch.BloomFilter = org.apache.spark.util.sketch.BloomFilterImpl@965e6c5e\n"}]},"apps":[],"jobName":"paragraph_1586641104878_965590146","id":"20200411-173824_554498703","dateCreated":"2020-04-11T17:38:24-0400","dateStarted":"2020-04-15T01:28:00-0400","dateFinished":"2020-04-15T01:28:01-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:243"},{"text":"//Applying broadcast join to filtered table\nval broadcast_join = spark.sparkContext.broadcast(final_bloomfilter)","user":"anonymous","dateUpdated":"2020-04-15T01:29:06-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"broadcast_join: org.apache.spark.broadcast.Broadcast[org.apache.spark.util.sketch.BloomFilter] = Broadcast(36)\n"}]},"apps":[],"jobName":"paragraph_1586641167931_-91352106","id":"20200411-173927_867806960","dateCreated":"2020-04-11T17:39:27-0400","dateStarted":"2020-04-15T01:29:06-0400","dateFinished":"2020-04-15T01:29:07-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:244"},{"text":"//filtering values that might be in the join\nval filtered = final_df.rdd.filter(c=> broadcast_join.value.mightContain(c(2)))","user":"anonymous","dateUpdated":"2020-04-15T01:32:40-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"filtered: org.apache.spark.rdd.RDD[org.apache.spark.sql.Row] = MapPartitionsRDD[102] at filter at <console>:29\n"}]},"apps":[],"jobName":"paragraph_1586641380185_475848439","id":"20200411-174300_1567036011","dateCreated":"2020-04-11T17:43:00-0400","dateStarted":"2020-04-15T01:32:40-0400","dateFinished":"2020-04-15T01:32:41-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:245"},{"text":"//count after join\nfiltered.count()","user":"anonymous","dateUpdated":"2020-04-15T01:35:21-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res6: Long = 9576387\n"}]},"apps":[],"jobName":"paragraph_1586641424417_810995306","id":"20200411-174344_994009086","dateCreated":"2020-04-11T17:43:44-0400","dateStarted":"2020-04-15T01:33:49-0400","dateFinished":"2020-04-15T01:34:52-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:246"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1586641444296_559195799","id":"20200411-174404_1824210322","dateCreated":"2020-04-11T17:44:04-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:247","text":"// to make a dataframe defining the columns\ncase class newType(col1: String, col2: String, col3: String, col4: String) extends Serializable","dateUpdated":"2020-04-15T01:36:53-0400","dateFinished":"2020-04-15T01:36:54-0400","dateStarted":"2020-04-15T01:36:53-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class newType\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1586929013219_38201658","id":"20200415-013653_1548159967","dateCreated":"2020-04-15T01:36:53-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1687","text":"// convorting filtered to a dataframe\nval filtered_df = filtered.map(x=> newType(x(0).toString, x(1).toString, x(2).toString, x(3).toString)).toDF()","dateUpdated":"2020-04-15T01:39:00-0400","dateFinished":"2020-04-15T01:39:01-0400","dateStarted":"2020-04-15T01:39:00-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"filtered_df: org.apache.spark.sql.DataFrame = [col1: string, col2: string ... 2 more fields]\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1586929140161_-1220930463","id":"20200415-013900_610976166","dateCreated":"2020-04-15T01:39:00-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1784","text":"//Dislaying the output of the joined dataframe.\nfiltered_df.show()","dateUpdated":"2020-04-15T01:39:50-0400","dateFinished":"2020-04-15T01:39:50-0400","dateStarted":"2020-04-15T01:39:50-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+--------------+--------------------+--------------+\n|      col1|          col2|                col3|          col4|\n+----------+--------------+--------------------+--------------+\n|2019-03-05|      Z305B2QN|         ST4000DM000| 4000787030016|\n|2019-03-05|      ZJV0XJQ4|       ST12000NM0007|12000138625024|\n|2019-03-05|      ZJV0XJQ3|       ST12000NM0007|12000138625024|\n|2019-03-05|      ZJV0XJQ0|       ST12000NM0007|12000138625024|\n|2019-03-05|PL1331LAHG1S4H|HGST HMS5C4040ALE640| 4000787030016|\n|2019-03-05|      ZA16NQJR|        ST8000NM0055| 8001563222016|\n|2019-03-05|      ZJV02XWG|       ST12000NM0007|12000138625024|\n|2019-03-05|      ZJV1CSVX|       ST12000NM0007|12000138625024|\n|2019-03-05|      ZJV02XWA|       ST12000NM0007|12000138625024|\n|2019-03-05|      ZA18CEBS|        ST8000NM0055| 8001563222016|\n|2019-03-05|      Z305DEMG|         ST4000DM000| 4000787030016|\n|2019-03-05|      ZA130TTW|         ST8000DM002| 8001563222016|\n|2019-03-05|      ZJV1CSVV|       ST12000NM0007|12000138625024|\n|2019-03-05|      ZA18CEBF|        ST8000NM0055| 8001563222016|\n|2019-03-05|      ZJV02XWV|       ST12000NM0007|12000138625024|\n|2019-03-05|PL2331LAG9TEEJ|HGST HMS5C4040ALE640| 4000787030016|\n|2019-03-05|PL2331LAH3WYAJ|HGST HMS5C4040BLE640| 4000787030016|\n|2019-03-05|PL1331LAHG53YH|HGST HMS5C4040BLE640| 4000787030016|\n|2019-03-05|  88Q0A0LGF97G| TOSHIBA MG07ACA14TA|14000519643136|\n|2019-03-05|PL2331LAHDUVVJ|HGST HMS5C4040BLE640| 4000787030016|\n+----------+--------------+--------------------+--------------+\nonly showing top 20 rows\n\r\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1586929161099_-1205643645","id":"20200415-013921_1104992409","dateCreated":"2020-04-15T01:39:21-0400","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1881"}],"name":"Q4 Midterm","id":"2F722UWPQ","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}
